define(["loading","libraryMenu","dom","emby-input","emby-button"],function(loading,libraryMenu,dom){"use strict";function load(page,device){page.querySelector("#txtCustomName",page).value=device.CustomName||"",page.querySelector(".reportedName",page).innerHTML=device.ReportedName||""}function loadData(){var page=this;loading.show();var id=getParameterByName("id"),promise1=ApiClient.getJSON(ApiClient.getUrl("Devices/Info",{Id:id}));Promise.all([promise1]).then(function(responses){load(page,responses[0]),loading.hide()})}function save(page){var id=getParameterByName("id");ApiClient.ajax({url:ApiClient.getUrl("Devices/Options",{Id:id}),type:"POST",data:JSON.stringify({CustomName:page.querySelector("#txtCustomName").value}),contentType:"application/json"}).then(Dashboard.processServerConfigurationUpdateResult)}function onSubmit(e){var form=this;return save(dom.parentWithClass(form,"page")),e.preventDefault(),!1}return function(view,params){view.querySelector("form").addEventListener("submit",onSubmit),view.addEventListener("viewshow",loadData)}});